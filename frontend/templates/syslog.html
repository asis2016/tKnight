{% extends 'base.html' %}

{% block title %}
Environment Variables
{% endblock %}

{% block content %}
<!-- TODO refactor -->
<style>
    ul.timeline {
        list-style-type: none;
        position: relative;
    }

    ul.timeline:before {
        content: ' ';
        background: var(--bs-teal);
        display: inline-block;
        position: absolute;
        left: 29px;
        width: 2px;
        height: 100%;
        z-index: 400;
    }

    ul.timeline>li {
        margin: 20px 0;
        padding-left: 20px;
    }

    ul.timeline>li:before {
        content: ' ';
        background: var(--bs-teal);
        display: inline-block;
        position: absolute;
        border-radius: 50%;
        border: 3px solid var(--bs-teal);
        left: 20px;
        width: 20px;
        height: 20px;
        z-index: 400;
    }
</style>
<div class="row" id="tuxSysLog">
    <div class="col-md-6">
        <ul class="timeline">
            <!-- data here -->
        </ul>
    </div>
</div>
{% endblock %}

{% block footer %}
<script>
    $.ajax({
        url: BASE_API_URL + '/syslog/',
        dataType: 'json',
        success: function (response) {
            let ul = $('#tuxSysLog .timeline');

            $.each(response['result'], function (index, item) {
                // Access each item in the array
                $.each(item, function () {
                    let li = $('<li>');
                    let p = $(`<p class="mb-0 d-flex justify-content-between w-100">`);

                    p.append(`<span><i class="bi bi-calendar-check me-1"></i>${item.datestamp}</span>`);
                    p.append(`<span><i class="bi bi-bookmark-dash-fill me-1"></i>${item.level}</span>`);

                    li.append(p)
                    li.append(`<p><small>${item.message}</small></p>`);
                    ul.append(li);
                });
            });
        },
        error: function () {
            console.error('Error fetching data:', error);
        }
    });

</script>
{% endblock footer %}